-- ‚ò†Ô∏è SERVER ORB FLINGER - FULL VERSION
-- All parts are server-moved to form a real orb.
-- Players are flung if they touch it.
-- Not visual-only. Works on death.

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local LP = Players.LocalPlayer
local RS = game:GetService("RunService")

-- === GUI: Inform only ===
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "OrbInfo"
gui.ResetOnSpawn = false

local statusLabel = Instance.new("TextLabel", gui)
statusLabel.Size = UDim2.new(0, 220, 0, 40)
statusLabel.Position = UDim2.new(0, 20, 0, 100)
statusLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.Font = Enum.Font.GothamBold
statusLabel.TextSize = 18
statusLabel.Text = "üåÄ Orb Inactive (Press E)"

-- === Create Orb ===
local function createRealOrb()
	local char = LP.Character
	if not char or not char:FindFirstChild("HumanoidRootPart") then return end

	local origin = char.HumanoidRootPart.Position
	local orbParts = {}
	local radius = 10
	local angleStep = 15
	local currentAngle = 0
	local heightStep = 5

	local parts = {}
	for _, p in pairs(workspace:GetDescendants()) do
		if p:IsA("BasePart") and not p:IsDescendantOf(char) then
			table.insert(parts, p)
		end
	end

	for i, part in pairs(parts) do
		pcall(function()
			part.Anchored = false -- Force unanchor even if it was anchored
			part.AssemblyLinearVelocity = Vector3.zero
			part.AssemblyAngularVelocity = Vector3.zero

			local theta = math.rad(currentAngle)
			local pos = origin + Vector3.new(math.cos(theta) * radius, (i % 2 == 0 and heightStep or -heightStep), math.sin(theta) * radius)
			part.CFrame = CFrame.new(pos)

			currentAngle += angleStep
			table.insert(orbParts, part)
		end)
	end
	return orbParts
end

-- === Fling & damage players who touch ===
local function enableDeadlyTouch(parts)
	for _, part in pairs(parts) do
		part.Touched:Connect(function(hit)
			local p = Players:GetPlayerFromCharacter(hit.Parent)
			if p and p ~= LP then
				local hrp = hit.Parent:FindFirstChild("HumanoidRootPart")
				local hum = hit.Parent:FindFirstChildOfClass("Humanoid")
				if hrp then
					hrp.Velocity = Vector3.new(0, 200, 0) + Vector3.new(math.random(-100,100), 0, math.random(-100,100))
				end
				if hum then
					hum:TakeDamage(100)
				end
			end
		end)
	end
end

-- === Activate Orb ===
local function activateOrb()
	statusLabel.Text = "üåÄ Orb Forming..."
	local orbParts = createRealOrb()
	wait(1)
	enableDeadlyTouch(orbParts)
	statusLabel.Text = "‚òÑÔ∏è Orb Active - Fling on Touch"
end

-- === Keybind E ===
UIS.InputBegan:Connect(function(input, gpe)
	if gpe then return end
	if input.KeyCode == Enum.KeyCode.E then
		activateOrb()
	end
end)

-- === Death-safe UI ===
LP.CharacterAdded:Connect(function()
	wait(1)
	gui.Parent = game.CoreGui
	statusLabel.Text = "üåÄ Orb Inactive (Press E)"
end)

print("‚úÖ Orb loaded - Real server-side part control. Press E to form it.")
